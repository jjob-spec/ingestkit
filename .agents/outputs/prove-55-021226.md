---
issue: 55
agent: PROVE
date: 2026-02-12
status: PASS
tests_passed: 615
tests_failed: 0
regressions: 0
core_tests: 83
excel_tests: 335
pdf_tests: 197
---

# PROVE: Issue #55 -- Extract ingestkit-core Shared Package

## Executive Summary

All verification levels PASS. The `ingestkit-core` package was correctly extracted with 15 `CoreErrorCode` members, `BaseIngestError`, 6 shared models, 4 protocols, and `compute_ingest_key`. Both sibling packages depend on core, re-export shared symbols with identity preservation, and all 615 tests pass (83 core + 335 Excel + 197 PDF) with zero regressions. No circular imports detected.

---

## Level 1 -- EXISTS

All 7 source files and 7 test files confirmed present:

| File | Status |
|------|--------|
| `packages/ingestkit-core/pyproject.toml` | EXISTS |
| `src/ingestkit_core/__init__.py` | EXISTS |
| `src/ingestkit_core/errors.py` | EXISTS |
| `src/ingestkit_core/models.py` | EXISTS |
| `src/ingestkit_core/protocols.py` | EXISTS |
| `src/ingestkit_core/idempotency.py` | EXISTS |
| `src/ingestkit_core/py.typed` | EXISTS (empty PEP 561 marker) |
| `tests/__init__.py` | EXISTS |
| `tests/conftest.py` | EXISTS |
| `tests/test_protocols.py` | EXISTS |
| `tests/test_models.py` | EXISTS |
| `tests/test_errors.py` | EXISTS |
| `tests/test_imports.py` | EXISTS |
| `tests/test_cross_package.py` | EXISTS |

## Level 2 -- SUBSTANTIVE

- `grep -rn "TODO|FIXME|HACK|PLACEHOLDER"` in core/src: **0 matches**
- `grep -rn "pass$|return False$|return []$|raise NotImplementedError"` in core/src: **0 matches**
- No stubs or placeholders detected.

## Level 3 -- WIRED

**Dependency declarations:**
- `packages/ingestkit-excel/pyproject.toml` line 11: `"ingestkit-core>=0.1.0"` -- CONFIRMED
- `packages/ingestkit-pdf/pyproject.toml` line 11: `"ingestkit-core>=0.1.0"` -- CONFIRMED

**Protocol identity (all 4):**
```
core.VectorStoreBackend is excel.VectorStoreBackend is pdf.VectorStoreBackend -- True
core.StructuredDBBackend is excel.StructuredDBBackend is pdf.StructuredDBBackend -- True
core.LLMBackend is excel.LLMBackend is pdf.LLMBackend -- True
core.EmbeddingBackend is excel.EmbeddingBackend is pdf.EmbeddingBackend -- True
```

**Model identity (5 shared models):**
```
IngestKey, WrittenArtifacts, EmbedStageResult, ClassificationTier, ChunkPayload
-- all share identity across core/excel/pdf -- True
```

**Subclassing:**
- `excel.ChunkMetadata` extends `core.BaseChunkMetadata` -- CONFIRMED
- `pdf.PDFChunkMetadata` extends `core.BaseChunkMetadata` -- CONFIRMED
- `excel.IngestError` extends `core.BaseIngestError` (has `sheet_name`) -- CONFIRMED
- `pdf.IngestError` extends `core.BaseIngestError` (has `page_number`) -- CONFIRMED

**Circular import check:**
```
import ingestkit_core  # loaded
# Check: no ingestkit_excel or ingestkit_pdf modules in sys.modules
# Result: 0 sibling modules loaded -- PASS
```

## Level 4 -- FUNCTIONAL

```
Core:  83 passed in 0.41s
Excel: 335 passed in 0.44s
PDF:   197 passed in 0.40s
Total: 615 passed, 0 failed, 0 errors
```

---

## Acceptance Criteria

| # | Criterion | Status |
|---|-----------|--------|
| 1 | `packages/ingestkit-core/` exists with correct structure | PASS |
| 2 | Core contains: CoreErrorCode (15), BaseIngestError, ClassificationTier, IngestKey, EmbedStageResult, BaseChunkMetadata, ChunkPayload, WrittenArtifacts, 4 protocols, compute_ingest_key | PASS |
| 3 | Both siblings list `ingestkit-core>=0.1.0` in dependencies | PASS |
| 4 | Excel `ChunkMetadata(BaseChunkMetadata)` and PDF `PDFChunkMetadata(BaseChunkMetadata)` | PASS |
| 5 | Excel `IngestError(BaseIngestError)` with `sheet_name`; PDF with `page_number` | PASS |
| 6 | Both packages re-export core protocols (identity: `excel.X is core.X`) | PASS |
| 7 | All existing Excel tests pass without modification | PASS (335/335) |
| 8 | All existing PDF tests pass without modification | PASS (197/197) |
| 9 | All new core tests pass (71+ tests from test plan) | PASS (83 tests) |
| 10 | No circular imports between any package pair | PASS |
| 11 | `import ingestkit_core` does not pull in excel or pdf | PASS |

---

## Comparison with PATCH

All PATCH claims verified. No discrepancies found.

- PATCH reported 83 core / 335 Excel / 197 PDF -- confirmed exact
- PATCH noted deviation: `__all__` has 13 symbols (not PLAN's 16) -- confirmed, count is correct
- PATCH noted `_is_runtime_protocol` fix -- tests pass, no issue

---

## Issues Found

None. All acceptance criteria met. No regressions.

---

## Outcome Recorded

Status: **PASS**

---

AGENT_RETURN: prove-55-021226.md
