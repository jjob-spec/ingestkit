---
issue: 22
agent: MAP-PLAN
date: 2026-02-11
complexity: COMPLEX
stack: backend
---

# MAP-PLAN: Issue #22 — Implement PDF data models (models.py)

## Executive Summary
Implement the complete data model layer for ingestkit-pdf: 8 enumerations, per-page models, document-level models, processing models, stage artifacts, and result models. All models use Pydantic v2. Pattern follows ingestkit-excel/models.py. ProcessingResult.error_details uses `Any` until errors.py (#23) is implemented.

## Investigation

### Pattern Reference
- `packages/ingestkit-excel/src/ingestkit_excel/models.py` (278 lines, 5 enums, 14 models)
- Spec §4.1-§4.5: complete model definitions with field types and computed properties

### Key Decisions
1. **error_details field**: `ProcessingResult.error_details: list[Any] = []` — IngestError not yet available (issue #23). Will be typed properly when errors.py exists.
2. **`from __future__ import annotations`**: enables forward references for `ExtractionQuality` in `PageProfile`.
3. **IngestKey**: follows exact Excel pattern with SHA-256 deterministic key.

## Implementation Plan

### Files to Create
1. **`src/ingestkit_pdf/models.py`** (~280 lines)
   - 8 enums: PDFType, PageType, ClassificationTier, IngestionMethod, OCREngine, ExtractionQualityGrade, ContentType
   - 2 per-page models: PageProfile, ExtractionQuality (with score/grade properties)
   - 3 document models: DocumentMetadata, DocumentProfile, ClassificationResult
   - 4 processing models: OCRResult, TableResult, PDFChunkMetadata, ChunkPayload
   - 5 stage artifacts: ParseStageResult, ClassificationStageResult, OCRStageResult, EmbedStageResult
   - 3 result models: WrittenArtifacts, ProcessingResult, IngestKey

2. **`tests/test_models.py`** (~400 lines)
   - Enum value tests for all 8 enums
   - ExtractionQuality score/grade property tests (boundary conditions)
   - IngestKey deterministic hash test
   - Model construction and serialization tests

### Acceptance Criteria
- [ ] All 8 enumerations defined with correct string values
- [ ] ExtractionQuality.score implements composite formula
- [ ] ExtractionQuality.grade returns correct grade based on thresholds
- [ ] IngestKey.key returns deterministic SHA-256 hash
- [ ] All models use Pydantic v2 BaseModel
- [ ] `pytest tests/test_models.py -q` passes
- [ ] `ruff check .` passes

AGENT_RETURN: .agents/outputs/map-plan-22-021126.md
